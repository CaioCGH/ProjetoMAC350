
\documentclass{report}
\usepackage[utf8]{inputenc}
\usepackage[portuges]{babel}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{titlesec}
\usetikzlibrary{er,positioning}
\renewcommand{\baselinestretch}{0.5}


\author{Caio Calisto Gaede Hirakawa \\ Matheus Santos Conceição}
\title{Exercício-Programa 1: Base de dados}
\begin{document}
\maketitle
\tableofcontents
\chapter{Parte I: Entendimento e validação do modelo}
\paragraph{Validar o modelo}
\chapter{Parte II: Descrição das classes abstratas}

\section{Entidades}
\subsection{Pessoa:}
\begin{itemize}
  \item Número USP  (Chave primária)
  \item CPF (Chave secundária)
  \item Nome
  \item E-mail
  \item Sexo
  \item Data de Nascimento
  \item Endereço:
  \begin{itemize}
  	\item Logradouro
  	\item Número
  	\item Complemento
  	\item Bairro
  	\item Município
  	\item Unidade Federativa
  	\item CEP
  	\end{itemize}
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Pessoa}
  child [grow=-130,level distance=3cm]{node[attribute] {pe\_Email}}
  child [grow=-30,level distance=3cm]{node[attribute] {pe\_Name}}
  child [grow=-55,level distance=3cm]{node[attribute] {\underline{pe\_NUSP}}}
  child [grow=+30,level distance=3cm]{node[attribute] {pe\_DataNasc}}
  child [grow=+60,level distance=3cm]{node[attribute] {pe\_Sexo}}
  child [grow=-95,level distance=3cm]{node[attribute] {\underline{\underline{pe\_CPF}}}}
  child [grow=0,level distance=3cm]{node[attribute] {pe\_Endereço}
    	child [grow=40,level distance=3cm]{node[attribute] {pe\_Numero}}
   		child [grow=16,level distance=4cm]{node[attribute] {pe\_Complemento}}
   		child [grow=4,level distance=3.5cm]{node[attribute] {pe\_Bairro}}
   		child [grow=-10,level distance=4cm]{node[attribute] {pe\_Municipio}}
   		child [grow=-25,level distance=4cm]{node[attribute] {pe\_UF}}
   		child [grow=-60,level distance=3cm]{node[attribute] {pe\_CEP}}
    };
\end{tikzpicture}

\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{pe\_NUSP:} Chave primária da entidade Pessoa. Sequência de 6 a 9 dígitos, englobando todos os números USP conhecidos e mais um dígito para quando os dígitos disponíveis não forem suficientes. Não pode ser nulo.
  \item \textbf{pe\_CPF:} Chave secundária da entidade Pessoa. Sequência de 11 dígitos que passe pelas regras de validação da Receita Federal:
  \begin{itemize}
  	\item verificação do primeiro dígito
  	\item verificação de segundo dígito
  	\item verificação de dígitos iguais
  \end{itemize}
  Não pode ser nulo.
  \item \textbf{pe\_Nome:} Sequência de letras maiúsculas e minúsculas, apóstrofe, hífen e espaço. No mínimo de 5 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{pe\_Email:} Sequência de 1 a 80 caracteres alfanuméricos e caracteres especiais \begin{verbatim}(!#$%&'*+-/=?^_`{|}~.)\end{verbatim} seguidos de um @, seguido de mais uma sequência de 1 a 80 caracteres alfanuméricos e caracteres especiais \begin{verbatim}(!#$%&'*+-/=?^_`{|}~.)\end{verbatim}.
  Não pode ser nulo.
  \item \textbf{pe\_DataNascimento:} no formato data dd/mm/aaaa. Não pode ser nulo.
  \item \textbf{pe\_Sexo:} M, F ou N, representando Sexo Masculino, Feminino ou Não declarado respectivamente.
  \item \textbf{pe\_Endereco:}
  \begin{itemize}
  	\item \textbf{pe\_Logradouro:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  	\item \textbf{pe\_Numero}: Sequência de 1 a 10 caracteres alfanuméricos e espaço, com o intuito de permitir escrever "sem número". Não pode ser nulo.
  	\item \textbf{pe\_Complemento:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Pode ser nulo.
  	\item \textbf{pe\_Bairro:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  	\item \textbf{pe\_Municipio:} Complemento Logradouro: Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  	\item \textbf{pe\_UF:} Complemento Logradouro: Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  	\item \textbf{pe\_CEP:} Sequência de 5 dígitos, seguido de um hífen, seguidos de mais três dígitos. Não pode ser nulo.
  	\end{itemize}
\end{itemize}

\subsection{Aluno:}
\begin{itemize}
  \item Data de Ingresso
  \item Código do Curso
  \item Créditos acumulados
  \begin{itemize}
  	\item Obrigatórios
  	\item Optativos Eletivos
  	\item Optativos Livres
  \end{itemize}

\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Aluno}
  child [grow=+10,level distance=3cm]{node[attribute] {al\_CodCurso}}
  child [grow=-90,level distance=1cm]{node[attribute] {al\_DataIngresso}}
  child [grow=-10,level distance=3cm]{node[attribute] {al\_Creditos}
  	child [grow=-20,level distance=3cm]{node[attribute] {al\_Obrigatorios}}
  	child [grow=-70,level distance=2cm]{node[attribute] {al\_Eletivos}}
  	child [grow=-135,level distance=2cm]{node[attribute] {al\_Livres}}
  };
  
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{Data de Ingresso:} Data no formato dd/mm/aaaa. Não pode ser nulo.
  \item \textbf{Código do Curso:} Números entre 1 e +infinito. Não pode ser nulo.
  \item \textbf{Créditos acumulados:}
  \begin{itemize}
  	\item \textbf{Obrigatórios:} inteiro entre 0 e +infinito. Não pode ser nulo.
  	\item \textbf{Optativos Eletivos:} inteiro entre 0 e +infinito. Não pode ser nulo.
  	\item \textbf{Optativos Livres:} inteiro entre 0 e +infinito. Não pode ser nulo.
  \end{itemize}
\end{itemize}

\subsection{Professor:}
\begin{itemize}
  \item Departamento
  \item Data de Admissão
  \item Área de Atuação
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Professor}
  	child [grow=-30,level distance=3cm]{node[attribute] {pr\_Departamento}}
	child [grow=+0,level distance=3cm]{node[attribute] {pr\_Area}}
  	child [grow=-80,level distance=2.5cm]{node[attribute] {pr\_DataAdmissao}};
	\draw[black] (3, 0) ellipse (0.9 and 0.3);
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{pr\_Departamento:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{pr\_DataAdmissao:} Data no formato dd/mm/aaaa. Não pode ser nulo.
  \item \textbf{pr\_Area:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
\end{itemize}

\subsection{Administrador:}
\begin{itemize}
  \item Data de Início da Gestão
  \item Data de Término da Gestão
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Administrador}
  child [grow=-30,level distance=3cm]{node[attribute] {adm\_DataInicio}}
  child [grow=-80,level distance=2.5cm]{node[attribute] {adm\_DataTermino}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{adm\_DataInicio:} Data no formato dd/mm/aaaa. Não pode ser nulo.
  \item \textbf{adm\_DataTermino:} Data no formato dd/mm/aaaa. Não pode ser nulo.
\end{itemize}

\subsection{Disciplina:}
\begin{itemize}
  \item Nome
  \item Código (Chave Primária)
  \item Departamento
  \item Ementa
  \item Descrição
  \item Pré-requisitos
  \item Período ideal
  \item Créditos:
  \begin{itemize}
  	\item Aula
  	\item Trabalho
  	\end{itemize}
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Disciplina}
  	child [grow=45,level distance=3cm]{node[attribute] {dis\_Nome}}
  	child [grow=25,level distance=3cm]{node[attribute] {\underline{dis\_Codigo}}}
  	child [grow=130,level distance=2cm]{node[attribute] {dis\_Departamento}}
  	child [grow=-30,level distance=3.5cm]{node[attribute] {dis\_Ementa}}
  	child [grow=0,level distance=3.5cm]{node[attribute] {dis\_Pre-requisitos}}
  	child [grow=-60,level distance=3cm]{node[attribute] {dis\_Descrição}}
  	child [grow=-130,level distance=4cm]{node[attribute] {dis\_PeríodoIdeal}}
  	child [grow=180,level distance=4cm]{node[attribute] {dis\_Creditos}
  		child [grow=-150,level distance=2cm]{node[attribute] {dis\_Aula}}
  		child [grow=-60,level distance=1.5cm]{node[attribute] {dis\_Trabalho}}
  	};
	\draw[black] (3.5, 0) ellipse (1.9 and 0.3);
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{dis\_Nome:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{dis\_Codigo:}  Sequência de caracteres alfanuméricos. No mínimo de 4 e máximo de 9 caracteres. Não pode ser nulo.
  \item \textbf{dis\_Departamento:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{dis\_Ementa:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{dis\_Descricao:} Sequência de caracteres UTF-8. Mínimo de 4 e máximo de 1000 caracteres. Não pode ser nulo.
  \item \textbf{dis\_PreRequisitos:} Sequencia de caracteres alfanuméricos. No mínimo de 4 de 80 caracteres. 
  \item \textbf{dis\_PeriodoIdeal:}  Numéro inteiro entre 1 e 12.
  \item \textbf{dis\_Aula:} Inteiro positivo entre 1 e 50.
  \item \textbf{dis\_Trabalho:} Inteiro positivo entre 1 e 50.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\paragraph{Especialização da Disciplina:}
%\begin{itemize}
%	\item \textbf{Obrigatória:}
%			\begin{itemize}
%  				\item \textbf{teste:}
%			\end{itemize}
%			\begin{tikzpicture}
%  				\node[entity] (node1) {Obrigatória};
%			\end{tikzpicture}
%			\paragraph{Restrições Entidade Regular:}
%			\begin{itemize}
%				\item \textbf{teste2:}
%			\end{itemize}
%			
%	\item \textbf{Eletiva:}
%	\item \textbf{Livre:} 
%\end{itemize}
%
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%Acho que não precisa colocar Obrigatoria/eletiva/livre dentro de Disciplina. Declara como Entidade né? Mesmo sendo especialização

%eu acho que sim
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% parei de inserir as restrições aqui, mas mesmo restrições anteriores devem
% precisar de uma revisão, principalmente no número max e min de carateres
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Currículo:}
\begin{itemize}
  \item Ano de Início (Chave primária)
   \item Ano de Fim
   \item Unidade
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Currículo}
  	child [grow=0,level distance=3cm]{node[attribute] {\underline{cur\_AnoIni}}}
	child [grow=-25,level distance=3.5cm]{node[attribute] {cur\_Unidade}}
	child [grow=-90,level distance=1.5cm]{node[attribute] {cur\_AnoFim}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{cur\_AnoIni:} Número inteiro de 4 dígitos entre 1500 e +infinito.
   \item \textbf{cur\_AnoFim:} Número inteiro de 4 dígitos entre 1500 e +infinito.
   \item \textbf{cur\_Unidade:} Sequência de caracteres. No mínimo de 2 até 80 caracteres.
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%INICIO INICIO INICIO INICIO INICIO%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\iffalse
\subsection{Obrigatória:}	
\begin{itemize}
  \item 
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Obrigatoria};
\end{tikzpicture}


\subsection{Optativa:}	
\begin{itemize}
 \item
\end{itemize}
\begin{tikzpicture}
 \node[entity] (node1) {Optativa};
\end{tikzpicture}

\subsection{Eletiva:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Eletiva};
\end{tikzpicture}

\subsection{Livre:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Livre};
\end{tikzpicture}
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%FIM FIM FIM FIM FIM FIM%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Módulo:}
\begin{itemize}
  \item Nome
  \item Código (Chave primária)
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Modulo}
  	child [grow=-30,level distance=3cm]{node[attribute] {mod\_Nome}}
  	child [grow=-80,level distance=3cm]{node[attribute] {\underline{mod\_Codigo}}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{mod\_Nome:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{mod\_Codigo:} Sequência de caracteres numéricos. No mínimo de 1 e máximo de 9 caracteres. Não pode ser nulo.
\end{itemize}


\subsection{Trilha:}
\begin{itemize}
  \item Nome
  \item Código (Chave primária)
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Trilha}
  	child [grow=-30,level distance=3cm]{node[attribute] {tr\_Nome}}
  	child [grow=-80,level distance=3cm]{node[attribute] {\underline{tr\_Codigo}}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{tr\_Nome:} Sequência de caracteres alfanuméricos, apóstrofe, hífen e espaço. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
  \item \textbf{tr\_Codigo:} Sequência de caracteres alfanuméricos. No mínimo de 4 e máximo de 9 caracteres. Não pode ser nulo.
\end{itemize}

\subsection{Usuário:}
\begin{itemize}
  \item Login (Chave primária)
  \item Senha
  \item Username
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Usuario}
  	child [grow=-10,level distance=3cm]{node[attribute] {\underline{us\_login}}}
  	child [grow=-30,level distance=3cm]{node[attribute] {us\_senha}}
  	child [grow=-60,level distance=3cm]{node[attribute] {us\_username}};
\end{tikzpicture}

\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{us\_login:} Sequência de caracteres alfanuméricos. No mínimo de 6 até 80 caracteres. Não pode ser nulo.
  \item \textbf{us\_senha:}  Sequência de caracteres alfanuméricos. No mínimo de 6 até 80 caracteres. Não pode ser nulo.
  \item \textbf{us\_username:} Sequência de caracteres alfanuméricos, separados ou não pode espaço. No mínimo de 6 até 80 caracteres. Não pode ser nulo.
\end{itemize}

\subsection{Perfil:}
\begin{itemize}
  \item Tipo
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Perfil}
  	child [grow=-90,level distance=1.5cm]{node[attribute] {\underline{pr\_Tipo}}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{pr\_Tipo:} Sequência de caracteres alfanuméricos. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
\end{itemize}

\subsection{Serviço:}
\begin{itemize}
  \item Nome (Chave primário)
  \item Descrição
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Serviço}
  child [grow=-90,level distance=1.5cm]{node[attribute] {\underline{ser\_Nome}}}
  child [grow=-20,level distance=3cm]{node[attribute] {ser\_Descrição}};
\end{tikzpicture}
\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{ser\_Nome:} Sequência de caracteres alfanuméricos. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.
    \item \textbf{ser\_Descrição:} Sequência de caracteres alfanuméricos. No mínimo de 4 e máximo de 80 caracteres. Não pode ser nulo.

\end{itemize}

\section{Agregados}

\subsection{Oferecimento:}
\begin{itemize}
  \item Data de Início (Chave Primária)
  \item Horário
  \item Vagas
\end{itemize}
\begin{tikzpicture}
  \node[entity] (node1) {Oferecimento}
  	child [grow=-45,level distance=2.5cm]{node[attribute] {\underline{of\_DataInicio}}}
  	child [grow=-90,level distance=3cm]{node[attribute] {of\_Horario}}
  	child [grow=-0,level distance=3cm]{node[attribute] {of\_Vagas}};
\end{tikzpicture}

\paragraph{Restrições Entidade Regular:}
\begin{itemize}
  \item \textbf{ser\_DataInicio:} Data no formato dd/mm/aaaa. Não pode ser nulo.
  \item \textbf{ser\_Horario:} Horário no formato "ddd hh:mm - hh:mm", no qual ddd = dia da semana, hh = hora (00-23) e mm=minutos (00-59). Não pode ser nulo.
  \item \textbf{ser\_Vagas:} Número inteiro entre 1 e +infinito. Não pode ser nulo.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%         Relacionamentos (estou achando que não precisa dessa parte
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{Relacionamentos}

\subsection{Ministra:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {Ministra};
\end{tikzpicture}

\subsection{Cursa:}
\begin{itemize}
  \item Data de Início
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {Cursa}
  	child [grow=-45,level distance=3cm]{node[attribute] {Data\_Inicio}};
\end{tikzpicture}

\subsection{Planeja:}
\begin{itemize}
  \item Data de Inscrição
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {Planeja}
  	child [grow=-45,level distance=3cm]{node[attribute] {Data\_Inscricao}};
\end{tikzpicture}

\subsection{Administra:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {Administra};
\end{tikzpicture}

\subsection{rel\_dis\_cur:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {rel\_dis\_cur};
\end{tikzpicture}

\subsection{op\_mod:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {op\_mod};
\end{tikzpicture}

\subsection{tr\_mod:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {tr\_mod};
\end{tikzpicture}

\subsection{us\_pf:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {us\_pf};
\end{tikzpicture}

\subsection{pf\_se:}
\begin{itemize}
  \item
\end{itemize}
\begin{tikzpicture}
  \node[relationship] (node1) {pf\_se};
\end{tikzpicture}
\end{document}
